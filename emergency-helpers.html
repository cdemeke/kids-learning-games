<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Emergency Helpers - Fire & Police Heroes!</title>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;800&family=Poppins:wght@600;700&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(180deg, #74b9ff 0%, #a8e6cf 100%);
            min-height: 100vh;
            overflow: hidden;
            touch-action: manipulation;
        }

        .game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            max-width: 1000px;
            margin: 0 auto;
            background: linear-gradient(180deg,
                    #74b9ff 0%,
                    #81ecec 40%,
                    #55a3ff 40%,
                    #a8e6cf 60%,
                    #55efc4 100%);
            overflow: hidden;
        }

        /* Sun */
        .sun {
            position: absolute;
            top: 20px;
            right: 70px;
            width: 75px;
            height: 75px;
            background: radial-gradient(circle at 40% 40%, #fff9c4, #ffd93d);
            border-radius: 50%;
            box-shadow:
                0 0 60px rgba(255, 217, 61, 0.8),
                0 0 100px rgba(255, 217, 61, 0.4);
            animation: sunPulse 3s ease-in-out infinite;
        }

        .sun::before {
            content: 'üòä';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2.5rem;
        }

        @keyframes sunPulse {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.08);
            }
        }

        /* Clouds */
        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            animation: floatCloud 30s linear infinite;
        }

        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50%;
        }

        .cloud-1 {
            width: 100px;
            height: 40px;
            top: 50px;
            left: -150px;
        }

        .cloud-1::before {
            width: 55px;
            height: 55px;
            top: -28px;
            left: 15px;
        }

        .cloud-1::after {
            width: 40px;
            height: 40px;
            top: -15px;
            left: 55px;
        }

        .cloud-2 {
            width: 80px;
            height: 35px;
            top: 100px;
            left: -250px;
            animation-delay: -15s;
        }

        .cloud-2::before {
            width: 45px;
            height: 45px;
            top: -22px;
            left: 10px;
        }

        .cloud-2::after {
            width: 35px;
            height: 35px;
            top: -12px;
            left: 45px;
        }

        @keyframes floatCloud {
            from {
                transform: translateX(0);
            }

            to {
                transform: translateX(calc(100vw + 300px));
            }
        }

        /* Title */
        h1 {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Baloo 2', cursive;
            color: #2d3436;
            font-size: clamp(1.4rem, 5vw, 2.2rem);
            text-shadow: 0 3px 0 rgba(255, 255, 255, 0.8);
            white-space: nowrap;
            z-index: 10;
        }

        /* Score */
        .score-board {
            position: absolute;
            top: 52px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: clamp(10px, 3vw, 25px);
            z-index: 10;
        }

        .score-item {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
            padding: 8px clamp(15px, 4vw, 25px);
            border-radius: 30px;
            font-size: clamp(0.85rem, 2.5vw, 1.15rem);
            color: #2d3436;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            font-weight: 700;
        }

        .score-item span {
            color: #e74c3c;
        }

        /* Road */
        .road {
            position: absolute;
            bottom: 70px;
            left: 0;
            right: 0;
            height: 65px;
            background: linear-gradient(180deg, #636e72, #2d3436);
            box-shadow: 0 -4px 0 #b2bec3;
        }

        .road::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 5px;
            background: repeating-linear-gradient(90deg, #ffeaa7 0px, #ffeaa7 35px, transparent 35px, transparent 70px);
            transform: translateY(-50%);
            animation: roadMove 1s linear infinite;
        }

        @keyframes roadMove {
            from {
                background-position: 0 0;
            }

            to {
                background-position: 70px 0;
            }
        }

        /* Buildings */
        .buildings {
            position: absolute;
            bottom: 135px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            padding: 0 clamp(20px, 5vw, 60px);
        }

        .building {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .fire-station {
            width: clamp(100px, 25vw, 150px);
            height: clamp(75px, 18vw, 110px);
            background: linear-gradient(180deg, #ff7675, #d63031);
            border-radius: 15px 15px 0 0;
            position: relative;
            box-shadow: 0 8px 30px rgba(214, 48, 49, 0.4);
        }

        .fire-station::before {
            content: 'üöí';
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(1.8rem, 5vw, 2.8rem);
        }

        .fire-station::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 25%;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.4), transparent);
            border-radius: 15px 15px 0 0;
        }

        .fire-station-door {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 55%;
            height: 50%;
            background: linear-gradient(180deg, #922b21, #641e16);
            border-radius: 8px 8px 0 0;
        }

        .station-sign {
            background: white;
            padding: 6px 15px;
            border-radius: 12px;
            font-weight: bold;
            font-size: clamp(0.65rem, 2vw, 0.9rem);
            margin-top: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .fire-station-sign {
            color: #d63031;
        }

        .police-station-sign {
            color: #0984e3;
        }

        .police-station {
            width: clamp(100px, 25vw, 150px);
            height: clamp(75px, 18vw, 110px);
            background: linear-gradient(180deg, #74b9ff, #0984e3);
            border-radius: 15px 15px 0 0;
            position: relative;
            box-shadow: 0 8px 30px rgba(9, 132, 227, 0.4);
        }

        .police-station::before {
            content: 'üöî';
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            font-size: clamp(1.8rem, 5vw, 2.8rem);
        }

        .police-station::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 25%;
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.4), transparent);
            border-radius: 15px 15px 0 0;
        }

        .police-station-door {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 55%;
            height: 50%;
            background: linear-gradient(180deg, #2471a3, #1a5276);
            border-radius: 8px 8px 0 0;
        }

        /* Emergency Scene */
        .emergency-scene {
            position: absolute;
            top: 115px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(180deg, #fff, #f8f9fa);
            padding: clamp(18px, 4vw, 30px) clamp(25px, 6vw, 50px);
            border-radius: 30px;
            text-align: center;
            box-shadow:
                0 15px 50px rgba(0, 0, 0, 0.15),
                0 0 0 4px rgba(255, 255, 255, 0.8);
            z-index: 20;
            transition: opacity 0.3s, transform 0.3s;
        }

        .emergency-icon {
            font-size: clamp(3.5rem, 12vw, 5.5rem);
            margin-bottom: 8px;
            animation: emergencyBounce 0.8s ease-in-out infinite;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
        }

        @keyframes emergencyBounce {

            0%,
            100% {
                transform: scale(1) rotate(-3deg);
            }

            50% {
                transform: scale(1.08) rotate(3deg);
            }
        }

        .emergency-text {
            font-family: 'Baloo 2', cursive;
            font-size: clamp(1.1rem, 3.5vw, 1.5rem);
            color: #2d3436;
            margin-bottom: 8px;
        }

        .emergency-hint {
            font-size: clamp(0.85rem, 2.5vw, 1.05rem);
            color: #636e72;
            font-weight: 600;
        }

        .emergency-hint strong {
            color: #d63031;
        }

        .emergency-hint .police-hint {
            color: #0984e3;
        }

        /* Keyboard controls */
        .keyboard-controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: clamp(20px, 6vw, 40px);
            z-index: 10;
        }

        .key-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.1s;
        }

        .key-button.pressed .key-cap {
            transform: translateY(5px);
        }

        .key-cap {
            width: clamp(75px, 20vw, 110px);
            height: clamp(75px, 20vw, 110px);
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(2rem, 6vw, 2.8rem);
            font-weight: bold;
            color: white;
            position: relative;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
            text-shadow: 0 3px 0 rgba(0, 0, 0, 0.2);
        }

        .key-cap::after {
            content: '';
            position: absolute;
            width: 40%;
            height: 18%;
            background: rgba(255, 255, 255, 0.35);
            border-radius: 10px;
            top: 12px;
            left: 20%;
        }

        .key-fire .key-cap {
            background: linear-gradient(180deg, #ff7675, #d63031);
            box-shadow: 0 8px 0 #a71d2a, 0 12px 30px rgba(214, 48, 49, 0.5);
        }

        .key-fire.pressed .key-cap {
            box-shadow: 0 3px 0 #a71d2a, 0 8px 20px rgba(214, 48, 49, 0.5);
        }

        .key-police .key-cap {
            background: linear-gradient(180deg, #74b9ff, #0984e3);
            box-shadow: 0 8px 0 #065a9e, 0 12px 30px rgba(9, 132, 227, 0.5);
        }

        .key-police.pressed .key-cap {
            box-shadow: 0 3px 0 #065a9e, 0 8px 20px rgba(9, 132, 227, 0.5);
        }

        .key-label {
            margin-top: 10px;
            font-size: clamp(0.8rem, 2.5vw, 1rem);
            color: #2d3436;
            font-weight: bold;
        }

        .key-icon {
            font-size: clamp(1.2rem, 3.5vw, 1.6rem);
            margin-top: 3px;
        }

        /* Vehicles */
        .vehicle {
            position: absolute;
            bottom: 78px;
            font-size: clamp(2.5rem, 8vw, 4rem);
            z-index: 15;
            filter: drop-shadow(4px 6px 8px rgba(0, 0, 0, 0.3));
        }

        .fire-truck {
            left: clamp(30px, 8vw, 90px);
        }

        .police-car {
            right: clamp(30px, 8vw, 90px);
        }

        .vehicle.driving {
            animation: vehicleDrive 1.8s ease-in-out forwards;
        }

        .vehicle.driving-back {
            animation: vehicleDriveBack 1.3s ease-in-out forwards;
        }

        @keyframes vehicleDrive {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(calc(50vw - 150px));
            }
        }

        @keyframes vehicleDriveBack {
            0% {
                transform: translateX(calc(50vw - 150px));
            }

            100% {
                transform: translateX(0);
            }
        }

        .vehicle.driving-right {
            animation: vehicleDriveRight 1.8s ease-in-out forwards;
        }

        .vehicle.driving-back-right {
            animation: vehicleDriveBackRight 1.3s ease-in-out forwards;
        }

        @keyframes vehicleDriveRight {
            0% {
                transform: translateX(0) scaleX(-1);
            }

            100% {
                transform: translateX(calc(-50vw + 150px)) scaleX(-1);
            }
        }

        @keyframes vehicleDriveBackRight {
            0% {
                transform: translateX(calc(-50vw + 150px)) scaleX(-1);
            }

            100% {
                transform: translateX(0) scaleX(-1);
            }
        }

        /* Siren lights */
        .siren {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }

        .siren-light {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            animation: sirenFlash 0.25s ease-in-out infinite alternate;
        }

        .siren-red {
            background: #ff4757;
            box-shadow: 0 0 15px #ff4757;
        }

        .siren-blue {
            background: #3498db;
            animation-delay: 0.125s;
            box-shadow: 0 0 15px #3498db;
        }

        @keyframes sirenFlash {
            0% {
                opacity: 0.3;
                transform: scale(0.8);
            }

            100% {
                opacity: 1;
                transform: scale(1.3);
            }
        }

        /* Result messages */
        .result-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Baloo 2', cursive;
            font-size: clamp(2rem, 8vw, 3.5rem);
            z-index: 100;
            pointer-events: none;
            animation: resultPop 1.5s ease-out forwards;
        }

        .result-message.success {
            color: #00b894;
            text-shadow: 0 4px 0 rgba(0, 0, 0, 0.2), 0 0 30px rgba(0, 184, 148, 0.6);
        }

        .result-message.wrong {
            color: #fdcb6e;
            text-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
        }

        @keyframes resultPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }

            30% {
                transform: translate(-50%, -50%) scale(1.3);
                opacity: 1;
            }

            100% {
                transform: translate(-50%, -70%) scale(1);
                opacity: 0;
            }
        }

        /* Stars earned */
        .stars-container {
            position: absolute;
            top: 95px;
            right: clamp(15px, 4vw, 35px);
            display: flex;
            gap: 6px;
            z-index: 10;
        }

        .star {
            font-size: clamp(1.5rem, 5vw, 2.2rem);
            opacity: 0.25;
            transition: all 0.4s ease;
            filter: grayscale(1);
        }

        .star.earned {
            opacity: 1;
            filter: grayscale(0) drop-shadow(0 0 10px rgba(255, 215, 0, 0.8));
            animation: starEarn 0.6s ease-out;
        }

        @keyframes starEarn {
            0% {
                transform: scale(0) rotate(-180deg);
            }

            70% {
                transform: scale(1.4) rotate(15deg);
            }

            100% {
                transform: scale(1) rotate(0deg);
            }
        }

        /* Overlay screens */
        .overlay-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1000;
        }

        .start-screen {
            background: linear-gradient(180deg, #74b9ff 0%, #81ecec 50%, #a8e6cf 100%);
        }

        .celebration {
            background: linear-gradient(180deg, #74b9ff 0%, #81ecec 50%, #a8e6cf 100%);
        }

        .overlay-screen h2 {
            font-family: 'Baloo 2', cursive;
            font-size: clamp(2rem, 7vw, 3.2rem);
            color: #2d3436;
            text-shadow: 0 3px 0 rgba(255, 255, 255, 0.8);
            margin-bottom: 10px;
            text-align: center;
        }

        .overlay-screen .heroes {
            font-size: clamp(4rem, 15vw, 6rem);
            margin: 20px 0;
            animation: heroFloat 2s ease-in-out infinite;
        }

        @keyframes heroFloat {

            0%,
            100% {
                transform: translateY(0) rotate(-2deg);
            }

            50% {
                transform: translateY(-15px) rotate(2deg);
            }
        }

        .overlay-screen p {
            font-size: clamp(1rem, 3.5vw, 1.4rem);
            color: #636e72;
            margin-bottom: 25px;
            text-align: center;
            max-width: 420px;
            line-height: 1.5;
            padding: 0 20px;
            font-weight: 600;
        }

        .btn {
            background: linear-gradient(180deg, #00b894, #00a085);
            color: white;
            border: none;
            padding: clamp(15px, 4vw, 22px) clamp(40px, 12vw, 60px);
            font-size: clamp(1.4rem, 5vw, 2rem);
            border-radius: 50px;
            cursor: pointer;
            font-family: 'Baloo 2', cursive;
            box-shadow: 0 6px 0 #007a63, 0 12px 30px rgba(0, 184, 148, 0.4);
            transition: transform 0.2s;
            text-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
        }

        .start-screen .btn {
            background: linear-gradient(180deg, #ff7675, #d63031);
            box-shadow: 0 6px 0 #a71d2a, 0 12px 30px rgba(214, 48, 49, 0.4);
        }

        .btn:hover {
            transform: translateY(-3px);
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #007a63;
        }

        /* Sparkles */
        .sparkle {
            position: absolute;
            width: 25px;
            height: 25px;
            pointer-events: none;
            z-index: 50;
        }

        .sparkle::before,
        .sparkle::after {
            content: '';
            position: absolute;
            background: #ffd700;
            border-radius: 3px;
        }

        .sparkle::before {
            width: 100%;
            height: 5px;
            top: 50%;
            transform: translateY(-50%);
        }

        .sparkle::after {
            width: 5px;
            height: 100%;
            left: 50%;
            transform: translateX(-50%);
        }

        .sparkle {
            animation: sparkleAnim 0.7s ease-out forwards;
        }

        @keyframes sparkleAnim {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: scale(2.5) rotate(45deg);
                opacity: 0;
            }
        }

        /* Confetti */
        .confetti {
            position: absolute;
            width: 12px;
            height: 12px;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        .hidden {
            display: none !important;
        }

        /* Sound toggle */
        .sound-toggle {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            font-size: 1.4rem;
            cursor: pointer;
            z-index: 2000;
            box-shadow: 0 3px 15px rgba(0, 0, 0, 0.15);
        }

        .sound-toggle.muted {
            opacity: 0.5;
        }

        /* Grass at bottom */
        .grass {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: linear-gradient(180deg, #55efc4, #00b894);
        }

        .home-btn {
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1000;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.8));
            border: 3px solid #ffd93d;
            color: #2d3436;
            padding: 10px 18px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 700;
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .home-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        /* Mobile adjustments */
        @media (max-width: 600px) {
            .keyboard-controls {
                bottom: clamp(15px, 3vh, 25px);
                gap: clamp(15px, 4vw, 30px);
            }

            .key-cap {
                width: clamp(65px, 18vw, 95px);
                height: clamp(65px, 18vw, 95px);
            }

            .emergency-scene {
                top: clamp(100px, 18vh, 130px);
                padding: clamp(15px, 3vw, 25px) clamp(20px, 5vw, 40px);
            }
        }

        @media (max-height: 650px) {
            .keyboard-controls {
                bottom: 10px;
            }

            .road {
                bottom: 80px;
                height: 55px;
            }

            .grass {
                height: 60px;
            }

            .buildings {
                bottom: 135px;
            }
        }
    </style>
</head>

<body>
    <a href="index.html" class="home-btn">üè† Home</a>
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>

    <div class="game-container" id="gameContainer">
        <!-- Sky -->
        <div class="sun"></div>
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>

        <h1>Emergency Helpers!</h1>

        <!-- Score -->
        <div class="score-board">
            <div class="score-item">People Helped: <span id="score">0</span></div>
            <div class="score-item">Level: <span id="level">1</span></div>
        </div>

        <!-- Stars -->
        <div class="stars-container">
            <div class="star" id="star1">‚≠ê</div>
            <div class="star" id="star2">‚≠ê</div>
            <div class="star" id="star3">‚≠ê</div>
        </div>

        <!-- Emergency Scene -->
        <div class="emergency-scene" id="emergencyScene">
            <div class="emergency-icon" id="emergencyIcon">üî•</div>
            <div class="emergency-text" id="emergencyText">Oh no! A small fire!</div>
            <div class="emergency-hint">
                Press <strong>F</strong> for Fire Truck or <strong class="police-hint">P</strong> for Police!
            </div>
        </div>

        <!-- Buildings -->
        <div class="buildings">
            <div class="building">
                <div class="fire-station">
                    <div class="fire-station-door"></div>
                </div>
                <div class="station-sign fire-station-sign">FIRE STATION</div>
            </div>

            <div class="building">
                <div class="police-station">
                    <div class="police-station-door"></div>
                </div>
                <div class="station-sign police-station-sign">POLICE STATION</div>
            </div>
        </div>

        <!-- Road -->
        <div class="road"></div>

        <!-- Grass -->
        <div class="grass"></div>

        <!-- Vehicles -->
        <div class="vehicle fire-truck" id="fireTruck">
            üöí
            <div class="siren" id="fireSiren" style="display: none;">
                <div class="siren-light siren-red"></div>
                <div class="siren-light siren-blue"></div>
            </div>
        </div>

        <div class="vehicle police-car" id="policeCar">
            üöî
            <div class="siren" id="policeSiren" style="display: none;">
                <div class="siren-light siren-blue"></div>
                <div class="siren-light siren-red"></div>
            </div>
        </div>

        <!-- Keyboard Controls -->
        <div class="keyboard-controls">
            <div class="key-button key-fire" id="keyF" onclick="sendHelper('fire')">
                <div class="key-cap">F</div>
                <div class="key-label">Fire Truck</div>
                <div class="key-icon">üöí</div>
            </div>

            <div class="key-button key-police" id="keyP" onclick="sendHelper('police')">
                <div class="key-cap">P</div>
                <div class="key-label">Police Car</div>
                <div class="key-icon">üöî</div>
            </div>
        </div>
    </div>

    <!-- Start Screen -->
    <div class="overlay-screen start-screen" id="startScreen">
        <h2>Emergency Helpers!</h2>
        <div class="heroes">üöí üöî</div>
        <p>Help send the right heroes to save the day! Press F for Fire Truck or P for Police Car!</p>
        <button class="btn" onclick="startGame()">Let's Help!</button>
    </div>

    <!-- Celebration -->
    <div class="overlay-screen celebration hidden" id="celebration">
        <h2>You're a Super Helper!</h2>
        <div class="heroes">üöí ‚≠ê üöî</div>
        <p id="celebrationText">You helped so many people!</p>
        <button class="btn" onclick="nextLevel()">Keep Helping!</button>
    </div>

    <script>
        // Audio
        let audioCtx = null;
        let soundEnabled = true;

        function initAudio() {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!soundEnabled || !audioCtx) return;

            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);

            switch (type) {
                case 'siren':
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(600, audioCtx.currentTime + 0.2);
                    osc.frequency.setValueAtTime(800, audioCtx.currentTime + 0.4);
                    gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.6);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.6);
                    break;
                case 'success':
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(523, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(659, audioCtx.currentTime + 0.1);
                    osc.frequency.setValueAtTime(784, audioCtx.currentTime + 0.2);
                    osc.frequency.setValueAtTime(1047, audioCtx.currentTime + 0.3);
                    gain.gain.setValueAtTime(0.25, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.5);
                    break;
                case 'hint':
                    osc.type = 'triangle';
                    osc.frequency.setValueAtTime(400, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(350, audioCtx.currentTime + 0.1);
                    gain.gain.setValueAtTime(0.12, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.2);
                    break;
                case 'levelup':
                    osc.type = 'sine';
                    osc.frequency.setValueAtTime(440, audioCtx.currentTime);
                    osc.frequency.setValueAtTime(554, audioCtx.currentTime + 0.15);
                    osc.frequency.setValueAtTime(659, audioCtx.currentTime + 0.3);
                    osc.frequency.setValueAtTime(880, audioCtx.currentTime + 0.45);
                    gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.7);
                    osc.start();
                    osc.stop(audioCtx.currentTime + 0.7);
                    break;
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            const btn = document.getElementById('soundToggle');
            btn.textContent = soundEnabled ? 'üîä' : 'üîá';
            btn.classList.toggle('muted', !soundEnabled);
        }

        // Game state
        let score = 0;
        let level = 1;
        let currentEmergency = null;
        let isAnimating = false;
        let helpedThisLevel = 0;
        let starsEarned = 0;
        const helpNeededPerLevel = 5;

        const container = document.getElementById('gameContainer');

        // Emergency scenarios
        const emergencies = {
            fire: [
                { icon: 'üî•', text: "Oh no! A small campfire needs putting out!" },
                { icon: 'üè†üî•', text: "Help! The kitchen has smoke!" },
                { icon: 'üå≥üî•', text: "A little fire in the leaves!" },
                { icon: 'üéÇüî•', text: "Too many birthday candles!" },
                { icon: 'üç≥üí®', text: "Oops! Smoky pancakes!" },
                { icon: 'üî•üèïÔ∏è', text: "A campfire got too big!" }
            ],
            police: [
                { icon: 'üê±', text: "A kitty is stuck in a tree!" },
                { icon: 'üß∏', text: "Someone lost their teddy bear!" },
                { icon: 'üö≤', text: "Help find the missing bicycle!" },
                { icon: 'üêï', text: "A puppy ran away from home!" },
                { icon: 'üë∂', text: "A child needs help crossing!" },
                { icon: 'üéà', text: "Balloons flew away! Catch them!" },
                { icon: 'ü¶Ü', text: "Ducks crossing the road!" }
            ]
        };

        function startGame() {
            initAudio();
            document.getElementById('startScreen').classList.add('hidden');
            showNewEmergency();
        }

        function showNewEmergency() {
            const types = ['fire', 'police'];
            const type = types[Math.floor(Math.random() * types.length)];
            const scenarios = emergencies[type];
            const scenario = scenarios[Math.floor(Math.random() * scenarios.length)];

            currentEmergency = type;

            document.getElementById('emergencyIcon').textContent = scenario.icon;
            document.getElementById('emergencyText').textContent = scenario.text;

            const icon = document.getElementById('emergencyIcon');
            icon.style.animation = 'none';
            icon.offsetHeight;
            icon.style.animation = 'emergencyBounce 0.8s ease-in-out infinite';
        }

        function sendHelper(type) {
            if (isAnimating || !currentEmergency) return;
            initAudio();

            const keyEl = type === 'fire' ? document.getElementById('keyF') : document.getElementById('keyP');
            keyEl.classList.add('pressed');
            setTimeout(() => keyEl.classList.remove('pressed'), 150);

            isAnimating = true;

            const isCorrect = type === currentEmergency;
            const vehicle = type === 'fire' ? document.getElementById('fireTruck') : document.getElementById('policeCar');
            const siren = type === 'fire' ? document.getElementById('fireSiren') : document.getElementById('policeSiren');

            siren.style.display = 'flex';
            playSound('siren');

            if (type === 'fire') {
                vehicle.classList.add('driving');
            } else {
                vehicle.classList.add('driving-right');
            }

            setTimeout(() => {
                if (isCorrect) {
                    score++;
                    helpedThisLevel++;
                    document.getElementById('score').textContent = score;

                    showResultMessage('Great Job! ‚≠ê', true);
                    createSparkles();
                    playSound('success');

                    updateStars();

                    if (helpedThisLevel >= helpNeededPerLevel) {
                        setTimeout(showCelebration, 1500);
                    }
                } else {
                    showResultMessage('Try the other one!', false);
                    playSound('hint');
                }

                document.getElementById('emergencyScene').style.opacity = '0.3';

            }, 1600);

            setTimeout(() => {
                if (type === 'fire') {
                    vehicle.classList.remove('driving');
                    vehicle.classList.add('driving-back');
                } else {
                    vehicle.classList.remove('driving-right');
                    vehicle.classList.add('driving-back-right');
                }
            }, 2000);

            setTimeout(() => {
                siren.style.display = 'none';

                if (type === 'fire') {
                    vehicle.classList.remove('driving-back');
                } else {
                    vehicle.classList.remove('driving-back-right');
                }

                document.getElementById('emergencyScene').style.opacity = '1';

                if (isCorrect && helpedThisLevel < helpNeededPerLevel) {
                    showNewEmergency();
                }

                isAnimating = false;
            }, 3200);
        }

        function showResultMessage(text, isSuccess) {
            const msg = document.createElement('div');
            msg.className = 'result-message ' + (isSuccess ? 'success' : 'wrong');
            msg.textContent = text;
            container.appendChild(msg);
            setTimeout(() => msg.remove(), 1500);
        }

        function createSparkles() {
            const scene = document.getElementById('emergencyScene');
            const rect = scene.getBoundingClientRect();
            const containerRect = container.getBoundingClientRect();

            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = (rect.left - containerRect.left + Math.random() * rect.width) + 'px';
                    sparkle.style.top = (rect.top - containerRect.top + Math.random() * rect.height) + 'px';
                    container.appendChild(sparkle);
                    setTimeout(() => sparkle.remove(), 700);
                }, i * 70);
            }
        }

        function updateStars() {
            const stars = [
                document.getElementById('star1'),
                document.getElementById('star2'),
                document.getElementById('star3')
            ];

            if (helpedThisLevel >= 2 && starsEarned < 1) {
                stars[0].classList.add('earned');
                starsEarned = 1;
            }
            if (helpedThisLevel >= 4 && starsEarned < 2) {
                stars[1].classList.add('earned');
                starsEarned = 2;
            }
            if (helpedThisLevel >= 5 && starsEarned < 3) {
                stars[2].classList.add('earned');
                starsEarned = 3;
            }
        }

        function showCelebration() {
            const celebration = document.getElementById('celebration');
            celebration.classList.remove('hidden');
            playSound('levelup');

            document.getElementById('celebrationText').textContent =
                `You helped ${score} people! Amazing!`;

            const colors = ['#ff7675', '#74b9ff', '#ffeaa7', '#55efc4', '#a29bfe'];
            for (let i = 0; i < 60; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                    celebration.appendChild(confetti);
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 40);
            }
        }

        function nextLevel() {
            level++;
            helpedThisLevel = 0;
            starsEarned = 0;

            document.getElementById('star1').classList.remove('earned');
            document.getElementById('star2').classList.remove('earned');
            document.getElementById('star3').classList.remove('earned');

            document.getElementById('celebration').classList.add('hidden');
            document.getElementById('level').textContent = level;

            showNewEmergency();
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            const key = e.key.toLowerCase();

            if (!document.getElementById('startScreen').classList.contains('hidden')) {
                if (key === ' ' || key === 'enter' || key === 'f' || key === 'p') {
                    e.preventDefault();
                    startGame();
                    return;
                }
            }

            if (!document.getElementById('celebration').classList.contains('hidden')) {
                if (key === ' ' || key === 'enter') {
                    e.preventDefault();
                    nextLevel();
                    return;
                }
            }

            if (key === 'f' || e.key === 'ArrowLeft') {
                e.preventDefault();
                sendHelper('fire');
            }

            if (key === 'p' || e.key === 'ArrowRight') {
                e.preventDefault();
                sendHelper('police');
            }
        });
    </script>
</body>

</html>